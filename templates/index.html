{% extends "base.html" %}

{% block title %}Inicio{% endblock %}

{% block content %}
  <h2 class="mb-4">Listado de Clientes</h2>

  <div class="mb-3">
    <a class="btn btn-primary" href="{{ url_for('nuevo_cliente') }}">‚ûï Nuevo Cliente</a>
    <a class="btn btn-secondary" href="{{ url_for('liquidacion') }}">üìä Ver Liquidaci√≥n</a>
  </div>

  <p><strong>Hoy:</strong> {{ hoy.strftime("%d/%m/%Y") }}</p>

  {% if clientes %}
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>Orden</th>
          <th>C√≥digo</th>
          <th>Nombre</th>
          <th>Direcci√≥n</th>
          <th>Monto</th>
          <th>Plazo (d√≠as)</th>
          <th>Inter√©s (%)</th>
          <th>Saldo</th>
          <th>C (Abono hoy)</th> <!-- üëà nueva columna -->
          <th>Fecha creaci√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for c in clientes %}
          <tr class="{{ estado_class(c) }}">
            <td>
              <form action="{{ url_for('actualizar_orden', cliente_id=c.id) }}" method="post" class="d-flex">
                <input type="number" name="orden" value="{{ c.orden }}" class="form-control form-control-sm small-input" />
                <button type="submit" class="btn btn-sm btn-outline-primary">‚úî</button>
              </form>
            </td>
            <td>{{ c.codigo }}</td>
            <td>{{ c.nombre }}</td>
            <td>{{ c.direccion }}</td>
            <td>{{ "%.2f"|format(c.monto) }}</td>
            <td>{{ c.plazo }}</td>
            <td>{{ "%.2f"|format(c.interes) }}</td>
            <td>{{ "%.2f"|format(c.saldo) }}</td>
            <td>
              {% if c.abono_hoy %}
                ‚úÖ
              {% else %}
                ‚ùå
              {% endif %}
            </td>
            <td>{{ c.fecha_creacion.strftime("%d/%m/%Y") }}</td>
            <td>
              <form action="{{ url_for('abonar', cliente_id=c.id) }}" method="post" class="d-flex mb-1">
                <input type="number" step="0.01" name="monto_abono" class="form-control form-control-sm small-input" placeholder="Abono">
                <button type="submit" class="btn btn-sm btn-success">üíµ Abonar</button>
              </form>

              <form action="{{ url_for('eliminar_cliente', cliente_id=c.id) }}" method="post" onsubmit="return confirm('¬øSeguro que deseas eliminar este cliente?');">
                <button type="submit" class="btn btn-sm btn-danger">üóë Eliminar</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="alert alert-info">No hay clientes registrados todav√≠a.</div>
  {% endif %}
{% endblock %}

